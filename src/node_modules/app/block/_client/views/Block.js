import React from "react"
import {get} from "app/_shared/utils/ajax"
import {render as renderBlock} from "app/block/_client/widget"
import Link from "app/_client/views/Link"
import LoadingIcon from "app/_client/views/LoadingIcon"

const {Component, PropTypes} = React

class Block extends Component {

  static propTypes = {
    params: PropTypes.object.isRequired
  }

  componentDidMount() {
    const {params} = this.props
    get("/api/block/" + params.id).then(block => this.setState({
      block
    }))
    get("/api/block/" + params.id + "/data").then(data => this.setState({
      data
    }))
  }

  state = {}

  render() {
    const {block, data} = this.state
    return <div className="card m-a">
      <ul className="nav">
        <li className="nav-item">
          <Link to="/block">List</Link>
        </li>
      </ul>
      <div className="card-block">
        {block && data ? renderBlock(block.widget, block, data) : <LoadingIcon/>}
      </div>
    </div>
  }

}

export default Block
