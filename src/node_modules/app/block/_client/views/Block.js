import React from "react"
import {get} from "app/_shared/utils/ajax"
import {filter, range} from "app/_shared/utils"
import {render as renderBlock} from "app/block/_client/widget"
import LoadingIcon from "app/_client/views/LoadingIcon"
import Space from "app/_client/views/Space"

const {Component, PropTypes} = React

class Block extends Component {

  static propTypes = {
    params: PropTypes.object.isRequired
  }

  componentDidMount() {
    const {params} = this.props
    get("/api/block/" + params.id).then(block => this.setState({
      block
    }))
    get("/api/block/" + params.id + "/data").then(data => this.setState({
      data
    }))
  }

  state = {}

  render() {
    const {block, data} = this.state
    if (!(block && data)) {
      return <LoadingIcon/>
    }
    const filteredData = filter(data, record => record.location === 9)
    return <div className="row">
      <div className="col-md-3">
        <div>
          <button className="btn btn-primary" type="button" data-toggle="collapse" data-target="#categoryFilter"
              aria-expanded="false" aria-controls="categoryFilter">
            Category
          </button>
          <div className="collapse in" id="categoryFilter">
            <Space/>
            {range(1, 4).map(id => <div key={id} className="checkbox">
              <label>
                <input type="checkbox"/>
                {id}
              </label>
            </div>)}
          </div>
        </div>
        <Space/>
        <div>
          <button className="btn btn-primary" type="button" data-toggle="collapse" data-target="#locationFilter"
              aria-expanded="false" aria-controls="locationFilter">
            Location
          </button>
          <div className="collapse in" id="locationFilter">
            <Space/>
            {range(1, 11).map(id => <div key={id} className="checkbox">
              <label>
                <input type="checkbox"/>
                {id}
              </label>
            </div>)}
          </div>
        </div>
        <Space/>
      </div>
      <div className="col-md-9">
        <div>
          <button className="btn btn-primary" type="button" data-toggle="collapse" data-target="#timeFilter"
              aria-expanded="false" aria-controls="timeFilter">
            Time
          </button>
          <div className="collapse in" id="timeFilter">
            <Space/>
            {range(2010, 2015).map(id => <div key={id} className="radio-inline">
              <label>
                <input type="radio"/>
                {id}
              </label>
            </div>)}
          </div>
        </div>
        <Space/>
        <div className="card card-block">
          {renderBlock(block.widget, block, filteredData)}
        </div>
      </div>
    </div>
  }

}

export default Block
