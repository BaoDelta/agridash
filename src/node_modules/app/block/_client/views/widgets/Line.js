import React from "react"
import {findDOMNode} from "react-dom"
import {isString} from "app/_shared/utils"
import {getDefaultOptions, drawChart} from "app/block/_client/views/widgets/chart"

const {Component, PropTypes} = React

class Line extends Component {

  static propTypes = {
    widget: PropTypes.object.isRequired,
    block: PropTypes.object.isRequired,
    data: PropTypes.array.isRequired
  }

  componentDidMount() {
    this.drawChart()
  }

  drawChart() {
    const {widget, block, data} = this.props
    const chartOptions = getDefaultOptions(widget, block)
    chartOptions.xAxis.categories = data.map(record => record.time)
    chartOptions.series = widget.series.map(series => ({
      name: series.label,
      data: data.map(record => isString(record[series.id]) ? +record[series.id].replace(/,/g, "") : null)
    }))
    drawChart(findDOMNode(this), chartOptions)
  }

  render() {
    return <div></div>
  }

}

export default Line
