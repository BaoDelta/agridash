import _ from "lodash"

const loaderById = {}

export function register(loaders) {
  _.each(loaders, (loader, id) => {
    if (loaderById[id]) {
      throw new Error("More than one loader for [" + id + "]")
    }
    loaderById[id] = loader
  })
}

export function load(config) {
  const id = config.type
  const loader = loaderById[id]
  if (!loader) {
    throw new Error("No loader for [" + id + "]")
  }
  return loader(config)
}
