import mapnik from "mapnik"
import createMap from "app/tile/handlers/createMap"

function renderImage(layerOptions) {
  return function(request, reply) {
    createMap(request, layerOptions).then(map => {
      const image = new mapnik.Image(map.width, map.height)
      map.render(image, () => {
        reply(image.encodeSync("png")).type("image/png")
      })
    })
  }
}

export default renderImage
