export createResults from "app/tile/layers/createResults"

export function createQuery(layer, options) {
  return {
    bufferSize: 64,
    query: `select st_rotate(st_expand(pos, unit_width), -pi() / 8, pos) as geom, result,
        result::int * unit_width * 2 as height from (
      select pos, !pixel_width! * 6 as unit_width, ${options.columns} from ${options.table}
      where source = '${layer.locationType}' and pos && !bbox! order by lat desc, lng desc
    ) tmp`,
    style: `<Style name="${options.layerName}">
      <Rule>
        <Filter>[result] != ''</Filter>
        <BuildingSymbolizer fill="#ffeda0" height="[height]" fill-opacity="0.8"/>
      </Rule>
    </Style>`
  }
}
