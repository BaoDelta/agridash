import React from "react"
import {get} from "app/core/utils/ajax"
import LoadingIcon from "app/web/client/views/LoadingIcon"
import Link from "app/web/client/views/Link"

const {Component, PropTypes} = React

class Report extends Component {

  static propTypes = {
    params: PropTypes.object.isRequired
  }

  state = {}

  componentDidMount() {
    const {clientConfig} = window
    const {params} = this.props
    get(`${clientConfig.apiUrl}/report/${params.id}`).then(report => {
      this.setState({
        report
      })
    })
  }

  render() {
    const {report} = this.state
    if (!report) {
      return <LoadingIcon/>
    }
    return <div>
      <h2>{report.name}</h2>
      <ul>
        {report.views.map(view => <li key={view.id}>
          <Link to={`?view=${view.id}`}>{view.name}</Link>
        </li>)}
      </ul>
    </div>
  }

}

export default Report
