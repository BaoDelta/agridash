const {$} = window
const {alpaca: Alpaca} = $

function addToggleLoading(type, Field) {
  const FieldWithShowLoading = Field.extend({
    showLoading() {
      this.options.hidden = true
      this.field.hide()
      if (!this.loadingIcon) {
        this.loadingIcon = $("<i></i>").attr("class", "fa fa-sun-o fa-spin fa-2x")
        this.field.parent().append(this.loadingIcon)
      } else {
        this.loadingIcon.show()
      }
    },
    hideLoading() {
      if (this.loadingIcon) {
        this.loadingIcon.hide()
      }
      this.field.show()
      this.options.hidden = false
    }
  })
  Alpaca.registerFieldClass(type, FieldWithShowLoading)
}

addToggleLoading("select", Alpaca.Fields.SelectField)
