import "app/lib/handlebars/3.0.3/handlebars.js"
import "app/lib/alpaca/1.5.14/alpaca.css"
import "app/lib/alpaca/1.5.14/alpaca.js"

import {assign} from "app/core/utils"

const {$} = window
const {alpaca: Alpaca} = $

// Allow to show/hide loading state
assign(Alpaca.Field.prototype, {
  showLoading() {
    this.options.hidden = true
    this.field.hide()
    if (!this.loadingIcon) {
      this.loadingIcon = $("<i></i>").attr("class", "fa fa-sun-o fa-spin fa-2x")
      this.field.parent().append(this.loadingIcon)
    } else {
      this.loadingIcon.show()
    }
  },
  hideLoading() {
    if (this.loadingIcon) {
      this.loadingIcon.hide()
    }
    this.field.show()
    this.options.hidden = false
  }
})

// Allow to configure sorting selectable options
const {sortSelectableOptions} = Alpaca.ControlField.prototype
assign(Alpaca.ControlField.prototype, {
  sortSelectableOptions(selectableOptions) {
    if (this.options.disableSort) {
      return
    }
    sortSelectableOptions.call(this, selectableOptions)
  }
})
