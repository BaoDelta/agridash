import path from "path"
import Inert from "inert"
import renderReact from "app/web/handlers/renderReact"

export function register(server, options, next) {
  server.register(Inert, next)
  server.path(path.join(__dirname, "public"))
  server.route([
    {
      method: "GET",
      path: "/favicon.ico",
      handler: {file: "./favicon.ico"},
      config: {cache: {expiresIn: 86400000, privacy: "public"}}
    },
    {
      method: "GET",
      path: "/public/{path*}",
      handler: {directory: {path: "./"}}
    },
    {
      method: "GET",
      path: "/report/{id}",
      handler: renderReact
    }
  ])
  next()
}

register.attributes = {
  name: "agridash-web"
}
