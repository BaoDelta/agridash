import React from "react"
import {connect} from "react-redux"
import {createForm} from "app/web/forms/common"
import {getSchema as getReportSchema, getOptions as getReportOptions} from "app/web/forms/report"

const {Component, PropTypes} = React

class NewReportForm extends Component {

  static propTypes = {
    info: PropTypes.object.isRequired
  }

  componentDidMount() {
    const {info} = this.props
    this.removeForm = createForm(this.refs.container, getReportSchema(), getReportOptions(), {
      url: `${info.apiUrl}/report`,
      buttonLabel: "Create",
      done: report => {
        console.log(report)
      }
    })
  }

  componentWillUnmount() {
    if (this.removeForm) {
      this.removeForm()
    }
  }

  render() {
    return <div ref="container"></div>
  }

}

export default connect(state => ({info: state.info}))(NewReportForm)
